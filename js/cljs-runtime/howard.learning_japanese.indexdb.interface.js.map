{"version":3,"sources":["howard/learning_japanese/indexdb/interface.cljs"],"mappings":";AAIA;;;+EAAA,/EAAMA;AAAN,AAGE,YAAAC,QACC,WAAKC;AAAL,AACE,IAAMC,0HAAWC,lCACD,kBAAA,AAAAC,lBAACC,3BACD,AAACC,rDACD,+KAAA,mFAAA,sBAAA,xRAACC;IACXC,QAAM,4DAAA,5DAACC,sDAAgBP;IACvBQ,OAAK,qBAAA,rBAACC;AALZ,mDAMM,AAACC,qDAAeJ,xGAChB,+GAAA,xGAACK,kHACM,WAAKC;AAAL,AACE,IAAMC,qDAAW,AAAUD,1BACV,AAACE,lBACD,AAACX;AAFlB,AAGE,GAAI,WAAA,VAAMU;AACR,IAAME,SAAO,AAACC,2BAAYR;AAA1B,AACE,QAACT,oCAAAA,4CAAAA,VAAIgB,wBAAAA;;AACP,IAAME,iFAAQ,AAACC,oCAA4BL,rDAC7B,AAACM,1DACD,0KAAA,2EAAA,rPAACC;AAFf,AAGE,AAACC,mDAAMb,KAAKS;;0DACR,AAACC,oCAA4BL,9FAC7B,OAACS;;;;;AAE/B;;;+EAAA,/EAAMzB;AAAN,AAGE,YAAAC,QACC,WAAKC;AAAL,AACE,IAAMC,0HAAWC,lCACD,kBAAA,AAAAC,lBAACC,3BACD,AAACC,rDACD,+KAAA,mFAAA,sBAAA,xRAACC;IACXC,QAAM,4DAAA,5DAACC,sDAAgBP;IACvBQ,OAAK,qBAAA,rBAACC;AALZ,mDAMM,AAACC,qDAAeJ,xGAChB,+GAAA,xGAACK,kHACM,WAAKC;AAAL,AACE,IAAMC,qDAAW,AAAUD,1BACV,AAACE,lBACD,AAACX;AAFlB,AAGE,GAAI,WAAA,VAAMU;AACR,IAAME,SAAO,AAACC,2BAAYR;AAA1B,AACE,QAACT,oCAAAA,4CAAAA,VAAIgB,wBAAAA;;AACP,IAAME,iFAAQ,AAACC,oCAA4BL,rDAC7B,AAACM,1DACD,0KAAA,2EAAA,rPAACC;AAFf,AAGE,AAACC,mDAAMb,KAAKS;;0DACR,AAACC,oCAA4BL,9FAC7B,OAACS","names":["howard.learning-japanese.indexdb.interface/get-check-list-data-from-indexdb","js/Promise","res","trans","howard.learning-japanese.indexdb.interface/check-list-db","cljs.core/deref","indexed.db/result","indexed.db/create-database","indexed.db.transaction","store","indexed.db.object_store","data","cljs.core/transient","indexed.db.open_cursor","indexed.db.on","e","cursor","indexed.db/create-request","p-data","cljs.core/persistent!","val","indexed.db/create-cursor-with-value","indexed.db/value","cljs.core.js__GT_clj","cljs.core.conj_BANG_","indexed.db.continue$"],"sourcesContent":["(ns howard.learning-japanese.indexdb.interface\n  (:require\n   [indexed.db :as db]))\n\n(defn get-check-list-data-from-indexdb\n  \"get check-list-data-from indexdb\"\n  []\n  (js/Promise.\n   (fn [res]\n     (let [trans (-> @check-list-db\n                     (db/result)\n                     (db/create-database)\n                     (db/transaction [\"check-lists\"] \"readwrite\"))\n           store (db/object-store trans \"check-lists\")\n           data (transient [])]\n       (-> (db/open-cursor store)\n           (db/on \"success\"\n                  (fn [e]\n                    (let [cursor (-> (.-target e)\n                                     (db/create-request)\n                                     (db/result))]\n                      (if (nil? cursor)\n                        (let [p-data (persistent! data)]\n                          (res p-data))\n                        (let [val (-> (db/create-cursor-with-value cursor)\n                                      (db/value)\n                                      (js->clj :keywordize-keys true))]\n                          (conj! data val)\n                          (-> (db/create-cursor-with-value cursor)\n                              (db/continue))))))))))))\n\n(defn get-check-list-data-from-indexdb\n  \"get check-list-data-from indexdb\"\n  []\n  (js/Promise.\n   (fn [res]\n     (let [trans (-> @check-list-db\n                     (db/result)\n                     (db/create-database)\n                     (db/transaction [\"check-lists\"] \"readwrite\"))\n           store (db/object-store trans \"check-lists\")\n           data (transient [])]\n       (-> (db/open-cursor store)\n           (db/on \"success\"\n                  (fn [e]\n                    (let [cursor (-> (.-target e)\n                                     (db/create-request)\n                                     (db/result))]\n                      (if (nil? cursor)\n                        (let [p-data (persistent! data)]\n                          (res p-data))\n                        (let [val (-> (db/create-cursor-with-value cursor)\n                                      (db/value)\n                                      (js->clj :keywordize-keys true))]\n                          (conj! data val)\n                          (-> (db/create-cursor-with-value cursor)\n                              (db/continue))))))))))))\n"]}